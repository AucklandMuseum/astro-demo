---
import { contentfulClient } from "../lib/contentful";
import type { blogPost } from "../lib/contentful";
import BaseLayout from "../layouts/BaseLayout.astro";
import HorizontalCard from "../components/HorizontalCard.astro";
import previewImage from "../../public/itemPreview.png";

const entries = await contentfulClient.getEntries<blogPost>({
  content_type: "blogPost",
});

const posts = entries.items.map((item) => {
	const { title, publishDate, description, slug } = item.fields;

  return {
    title,
    publishDate: new Date(publishDate).toLocaleDateString(),
    description,
	slug
  };
});
---
<BaseLayout>
	<div>
		<div class="text-3xl w-full font-bold mb-5 mt-10">Latest from blog</div>
	  </div>
  
	  {
		posts.map((post) => (
		  <HorizontalCard
			title={post.title}
			img={previewImage}
			desc={post.description}
			url={'/posts/'+post.slug}
			target="_self"
		  />
		  <div class="divider my-0"></div>
		))
	  }

</BaseLayout>
